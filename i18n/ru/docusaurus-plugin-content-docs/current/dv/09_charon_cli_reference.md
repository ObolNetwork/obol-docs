---
description: Клиент промежуточного программного обеспечения на основе go для участия в кластерах Distributed Validator.
---

# CLI интерфейс Charon

:::caution

Клиент `charon` находится в стадии интенсивной разработки, интерфейсы могут быть изменены, пока не будет опубликована первая основная версия.

:::

Ниже приведена ссылка на версию charon [`v0.8.1`](https://github.com/ObolNetwork/charon/releases/tag/v0.8.1). Найдите последнюю версию в [нашем Github](https://github.com/ObolNetwork/charon/releases).

### Доступные команды

Ниже приведены команды верхнего уровня, доступные для использования.

```markdown
charon help
Charon обеспечивает отказоустойчивую работу валидаторов Ethereum, разделяя ключи проверки на группу доверенных сторон с использованием пороговой криптографии.

Usage:
  charon [command]

Available Commands:
  bootnode    Запуск загрузочного сервера diskv5
  completion  Сгенерировать скрипт автозаполнения для указанной оболочки
  create      Создание артефактов для кластера распределенного валидатора
  dkg         Принять участие в церемонии генерации распределенного ключа
  enr         Вывести запись узла Ethereum этого клиента (ENR)
  help        Справка по любой команде
  run         Запуск промежуточного клиента программного обеспечения charon
  version     Вывести версию клиента

Flags:
  -h, --help   Справка по командам Charon

Используйте "charon [command] --help" для получения дополнительной информации о команде.
```

### Вспомогательная команда `create`

Вспомогательная команда `create` управляет созданием артефактов, необходимых charon для работы.

```markdown
charon create --help
Создайте артефакты для кластера распределенного валидатора. Эти команды можно использовать для облегчения создания распределенного кластера валидатора между группой операторов путем выполнения церемонии генерации распределенного ключа, или их можно использовать для создания локального кластера для случаев использования одного оператора.

Usage:
  charon create [command]

Available Commands:
  cluster     Создать закрытые ключи и файлы конфигурации, необходимые для локального запуска кластера распределенного валидатора
  dkg         Создать конфигурацию для новой церемонии генерации распределенного ключа, используя charon dkg
  enr         Создать закрытый ключ Ethereum Node Record (ENR), чтобы идентифицировать этого клиента charon.

Flags:
  -h, --help   Дополнительная информация о команде

Используйте `charon create [command] --help` для получения дополнительной информации о команде.

```

#### Создание ENR в charon
 
`enr` — это запись узла Ethereum. Он используется для идентификации этого клиента charon для других клиентов-контрагентов charon через Интернет. 

```markdown
charon create enr --help
Создать закрытый ключ Ethereum Node Record (ENR) для идентификации этого клиента charon

Usage:
  charon create enr [flags]

Flags:
      --data-dir string                Каталог, в котором charon будет хранить все свои внутренние данные (default ".charon")
  -h, --help                           Дополнительная информация о команде enr
      --p2p-allowlist string           Разделенный запятыми список подсетей CIDR для разрешения только определенных одноранговых соединений. Пример: 192.168.0.0/16 разрешает подключения к одноранговым узлам только в вашей локальной сети. По умолчанию принимаются все соединения.
      --p2p-bootnode-relay             Позволяет использовать загрузочные узлы в качестве реле цепи libp2p. Полезно, если некоторые узлы charon недоступны публично.
      --p2p-bootnodes strings          Разделенный запятыми список URL-адресов или ENR загрузочных узлов diskv5. (по умолчанию [http://bootnode.gcp.obol.tech:3640/enr])
      --p2p-bootnodes-from-lockfile    Позволяет использовать ENR блокировки кластера в качестве загрузочных узлов diskv5. Позволяет пропускать явные загрузочные узлы, если церемония генерации ключей включала правильные IP-адреса.
      --p2p-denylist string            Разделенный запятыми список подсетей CIDR для запрета определенных одноранговых соединений. Пример: 192.168.0.0/16 запретит соединения с одноранговыми узлами в вашей локальной сети. По умолчанию принимаются все соединения.
      --p2p-external-hostname string   DNS-имя хоста, объявленное libp2p. Может использоваться для объявления внешнего DNS.
      --p2p-external-ip string         IP-адрес, объявленный libp2p. Может использоваться для внешнего IP-адреса.
      --p2p-tcp-address strings        Разделенный запятыми список прослушиваемых TCP-адресов (ip и порт) для трафика libP2P. (по умолчанию [127.0.0.1:3610])
      --p2p-udp-address string         Прослушивание UDP-адреса (ip и порт) для обнаружения diskv5. (по умолчанию "127.0.0.1:3630")
```

#### Создание полный кластер локально

`charon create cluster` локально создает набор распределенных валидаторов, включая закрытые ключи, файл `cluster.lock`, а также данные депозита и выхода. Однако эту команду следует использовать только для одиночного использования распределенных валидаторов. Для запуска распределенного валидатора с группой операторов предпочтительно создавать эти артефакты с помощью команды charon dkg. Таким образом, ни один оператор не хранит все закрытые ключи в распределенном валидаторе.

```markdown
charon create cluster --help
Создает локальную конфигурацию кластера charon, включая ключи валидатора, p2p-ключи charon, cluster-lock.json и Deposit-data.json. Смотрите флаги для поддерживаемых функций.

Usage:
  charon create cluster [flags]

Flags:
      --clean                       Удалить каталог кластера перед его созданием.
      --cluster-dir string          Целевая папка для создания кластера (по умолчанию ".charon/cluster")
  -h, --help                        Дополнитальная информация о команде
      --network string              Сеть Ethereum для создания валидаторов. Варинты: mainnet, prater, kintsugi, kiln, gnosis. (default: "prater")
  -n, --nodes int                   Количество узлов charon в кластере. (default 4)
      --split-existing-keys         Разделить существующий закрытый ключ валидатора на набор распределенных общих ключей валидатора. Не создает повторно данные депозита для этого ключа.
      --split-keys-dir string       Каталог, содержащий ключи для разделения. Ожидает ключи в keystore-*.json and passwords in keystore-*.txt. Требует --split-existing-keys.
  -t, --threshold int               Порог, необходимый для восстановления подписи. Минимум это n-(ceil(n/3)-1). (default 3)
      --withdrawal-address string   Адрес Ethereum для получения возвращенной ставки и начисленных вознаграждений. (default "0x0000000000000000000000000000000000000000")
```

#### Создание конфигурации для DKG Ceremony

Эта команда `charon create dkg` создает файл cluster_definition, используемый для команды `charon dkg`. 

```markdown
charon create dkg --help
Создайте файл определения кластера, который будет использоваться всеми участниками DKG.

Usage:
  charon create dkg [flags]

Flags:
      --dkg-algorithm string           Используемый алгоритм DKG; default, keycast, frost (default "default")
      --fee-recipient-address string   Необязательный адрес Ethereum получателя комиссии
  -h, --help                           Дополнитальная информация о команде
      --name string                    Необязательное имя косметического кластера
      --network string                 Сеть Ethereum для создания валидаторов. Options: mainnet, prater, kintsugi, kiln, gnosis. (default "prater")
      --num-validators int             Количество распределенных валидаторов, которыми будет управлять кластер (по 32ETH на каждого). (по умолчанию 1)
      --operator-enrs strings          Разделенный запятыми список адресов Charon ENR каждого оператора
      --output-dir string              Папка, в которую будет записан выходной файл cluster-definition.json. (по умолчанию ".charon")
  -t, --threshold int                  Порог, необходимый для восстановления подписи. Минимум n-(ceil(n/3)-1). (по умолчанию 3)
      --withdrawal-address string      Адрес для вывода Ethereum (default "0x0000000000000000000000000000000000000000")
```

### Проведение церемонии DKG

Команда `charon dkg` использует файл `cluster_definition.json`, который указывает charon условия создания нового кластера распределенного валидатора. Charon устанавливает связь с другими узлами, указанными в файле, выполняет церемонию генерации распределенного ключа для создания необходимых пороговых закрытых ключей и подписывает данные депозита и выхода для каждого нового распределенного валидатора. Команда выводит файл `cluster.lock` и общий ключ для каждого созданного распределенного валидатора. 

```markdown
charon dkg --help
Примите участие в церемонии создания распределенного ключа для определенного определения кластера, в ходе которой создаются распределенные общие ключи валидатора и окончательная конфигурация блокировки кластера. Обратите внимание, что все остальные операторы кластера должны запускать эту команду одновременно.

Usage:
  charon dkg [flags]

Flags:
      --data-dir string                Каталог, в котором charon будет хранить все свои внутренние данные (по умолчанию ".charon")
      --definition-file string         Путь к файлу определения кластера. (по умолчанию ".charon/cluster-definition.json")
  -h, --help                           Дополнительная информация о dgk
      --log-format string              Формат журнала; console, logfmt или json (по умолчанию "console")
      --log-level string               Уровень журнала; debug, info, warn or error (по умолчанию "info")
      --p2p-allowlist string           Разделенный запятыми список подсетей CIDR для разрешения только определенных одноранговых соединений. Пример: 192.168.0.0/16 разрешает подключения к одноранговым узлам только в вашей локальной сети. По умолчанию принимаются все соединения.
      --p2p-bootnode-relay             Позволяет использовать загрузочные узлы в качестве реле цепи libp2p. Полезно, если некоторые узлы харона недоступны публично.
      --p2p-bootnodes strings          Разделенный запятыми список URL-адресов или ENR загрузочных узлов diskv5. (по умолчанию [http://bootnode.gcp.obol.tech:3640/enr])
      --p2p-bootnodes-from-lockfile    Позволяет использовать ENR блокировки кластера в качестве загрузочных узлов diskv5. Позволяет пропускать явные загрузочные узлы, если церемония генерации ключей включала правильные IP-адреса.
      --p2p-denylist string            Разделенный запятыми список подсетей CIDR для запрета определенных одноранговых соединений. Пример: 192.168.0.0/16 запретит соединения с одноранговыми узлами в вашей локальной сети. По умолчанию принимаются все соединения.
      --p2p-external-hostname string   DNS-имя хоста, объявленное libp2p. Можно использовать для объявления внешнего DNS.
      --p2p-external-ip string         IP-адрес, объявленный libp2p. Можно использовать для внешнего IP-адреса.
      --p2p-tcp-address strings        Разделенный запятыми список прослушиваемых TCP-адресов (ip и порт) для трафика libP2P. (по умолчанию [127.0.0.1:3610])
      --p2p-udp-address string         Прослушивание UDP-адреса (ip и порт) для обнаружения diskv5. (по умолчанию "127.0.0.1:3630")
```

### Запуск промежуточного ПО Charon

Эта команда `run` принимает файл `cluster.lock`, который был создан с помощью команды `charon create cluster` или `charon dkg`. Этот файл блокировки описывает узлы в кластере и распределенные валидаторы, от имени которых они работают. 

```markdown
charon run --help
Запускает продолжительный процесс промежуточного программного обеспечения Charon для выполнения функций распределенного валидатора.

Usage:
  charon run [flags]

Flags:
      --beacon-node-endpoint string    URL-адрес конечной точки узла маяка (по умолчанию "http://localhost/")
      --data-dir string                Каталог, в котором charon будет хранить все свои внутренние данные (по умолчанию ".charon")
      --feature-set string             Минимальный набор функций для включения по умолчанию: alpha, beta, или stable. Предупреждение: меняйте на свой страх и риск. (default "stable")
      --feature-set-disable strings    Разделенный запятыми список функций, которые нужно отключить, переопределяя минимальный набор функций по умолчанию.
      --feature-set-enable strings     Разделенный запятыми список функций для включения, переопределяющий минимальный набор функций по умолчанию.
  -h, --help                           Дополнительная информация по команде run
      --jaeger-address string          Адрес прослушивания для трассировки jaeger
      --jaeger-service string          Имя службы, используемое для трассировки jaeger (по умолчанию "charon")
      --lock-file string               Путь к файлу блокировки кластера, определяющему кластер распределенного валидатора (по умолчанию «.charon/cluster-lock.json»)
      --log-format string              Формат логов; console, logfmt или json (по умолчанию "console")
      --log-level string               Формат логов; debug, info, warn or error (по умолчанию "info")
      --monitoring-address string      Адрес прослушивания (ip и порт) для API мониторинга (prometheus, pprof) (по умолчанию "127.0.0.1:3620")
      --p2p-allowlist string           Разделенный запятыми список подсетей CIDR для разрешения только определенных одноранговых соединений. Пример: 192.168.0.0/16 разрешает подключения к одноранговым узлам только в вашей локальной сети. По умолчанию принимаются все соединения.
      --p2p-bootnode-relay             Позволяет использовать загрузочные узлы в качестве реле цепи libp2p. Полезно, если некоторые узлы charon недоступны публично.
      --p2p-bootnodes strings          Разделенный запятыми список URL-адресов или ENR загрузочных узлов diskv5. (по умолчанию [http://bootnode.gcp.obol.tech:3640/enr])
      --p2p-bootnodes-from-lockfile    Позволяет использовать ENR блокировки кластера в качестве загрузочных узлов diskv5. Позволяет пропускать явные загрузочные узлы, если церемония генерации ключей включала правильные IP-адреса.
      --p2p-denylist string            Разделенный запятыми список подсетей CIDR для запрета определенных одноранговых соединений. Пример: 192.168.0.0/16 запретит соединения с одноранговыми узлами в вашей локальной сети. По умолчанию принимаются все соединения.
      --p2p-external-hostname string   DNS-имя хоста, объявленное libp2p. Можно использовать для объявления внешнего DNS.
      --p2p-external-ip string         IP-адрес, объявленный libp2p. Можно использовать для внешнего IP-адреса.
      --p2p-tcp-address strings        Разделенный запятыми список прослушиваемых TCP-адресов (ip и порт) для трафика libP2P. (по умолчанию [127.0.0.1:3610])
      --p2p-udp-address string         Прослушивание UDP-адреса (ip и порт) для обнаружения diskv5. (по умолчанию "127.0.0.1:3630")
      --simnet-beacon-mock             Включает внутренний фиктивный узел-маяк для запуска simnet.
      --simnet-validator-mock          Включает внутренний фиктивный клиент валидатора при запуске simnet. Требуется simnet-beacon-mock.
      --validator-api-address string   Адрес прослушивания (IP-адрес и порт) для трафика, обращенного к валидатору, проксирующего API-узла-маяка (по умолчанию «127.0.0.1:3600»)
```
