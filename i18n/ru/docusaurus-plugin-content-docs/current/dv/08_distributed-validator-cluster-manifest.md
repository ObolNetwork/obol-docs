---
description: Документирование распределенного кластера валидатора в стандартизированном формате файла
---

# Конфигурация кластера

:::caution
Эти файлы определения кластера и блокировки кластера находятся в стадии разработки. Цель состоит в том, чтобы файлы были стандартизированы для работы распределенных валидаторов через [процесс EIP](https://eips.ethereum.org/), когда это необходимо..
:::

В этом документе описываются параметры конфигурации для запуска клиента charon (или кластера) локально или в рабочей среде.

## Файлы конфигурации кластера

Кластер charon настраивается в два этапа:
- `cluster-definition.json` который определяет предполагаемую конфигурацию кластера до того, как ключи будут созданы на церемонии распределенного генерирования ключей.
- `cluster-lock.json` который включает в себя и расширяет `cluster-definition.json` с распределенными общими ключами BLS валидатора.

Команда `charon create dkg` используется для создания файла `cluster-definition.json`, который используется в качестве входных данных для «charon dkg».

Команда `charon create cluster` объединяет оба шага в один и просто выводит окончательный файл `cluster-lock.json` без шага DKG.

Схема `cluster-definition.json` определяется как:
```json
{
  "name": "best cluster",                       // Опционально,  косметический идентификатор
  "operators": [
    {
      "address": "0x123..abfc",                 // ETH1 адрес оператора
      "enr": "enr://abcdef...12345",            // ENR Charon узла
      "nonce": 1,                               // Nonce (увеличивается каждый раз, когда ENR добавляется/подписывается)
      "config_signature": "123456...abcdef",    // EIP712 Подпись config_hash по приватному ключу адреса ETH1
      "enr_signature": "123654...abcedf"        // EIP712 Подпись ENR по приватному ключу адреса ETH1
    }
  ],
  "uuid": "1234-abcdef-1234-abcdef",            // Случайный уникальный идентификатор.
  "version": "v1.0.0",                          // Версия схемы
  "num_validators": 100,                        // Количество распределенных валидаторов кластера, которые будут созданы в cluster.lock
  "threshold": 3,                               // Опционально, порог необходимый для восстановления подписи
  "fee_recipient_address":"0x123..abfc",        // ETH1 адрес получателя вознаграждения
  "withdrawal_address": "0x123..abfc",          // ETH1 адрес вывода
  "dkg_algorithm": "foo_dkg_v1" ,               // Опционально, алгоритм DKG для генерации ключей
  "fork_version": "0x00112233",                 // Идентификатор цепи/сети
  "config_hash": "abcfde...acbfed",             // Хэш статических (неизменяемых) полей
  "definition_hash": "abcdef...abcedef"         // Окончательный хэш всех полей
}
```

Приведенный выше файл `cluster-definition.json` предоставляется в качестве входных данных для DKG, который генерирует ключи и файл `cluster-lock.json`.


Файл `cluster-lock.json` имеет схему:
```json
{
  "cluster_definition": {...},                              // Определение кластера json, схема идентична приведенной выше.,
  "distributed_validators": [                               // Длина равная num_validators.
    {
      "distributed_public_key":  "0x123..abfc",             // Корневой открытый ключ DV
      "public_shares": [ "oA8Z...2XyT", "g1q...icu"],       // Совместно используемые открытые ключи
      "fee_recipient": "0x123..abfc"                        // Адрес по умолчанию для вывода средств, если он не установлен, может быть отредактирован вручную
    }
  ],
  "lock_hash": "abcdef...abcedef",                          // Config_hash + distributed_validators
  "signature_aggregate": "abcdef...abcedef"                 // Совокупная подпись BLS хэша блокировки, подписанного каждым открытым ключом DV.
}
```
