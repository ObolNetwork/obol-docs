<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v0.6.1 plugin-docs plugin-id-default docs-doc-id-dvk/distributed-validator-keys" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Distributed Validator Key Generation | Obol Network</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.obol.tech/docs/v0.6.1/dvk/distributed-validator-keys"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:image" content="/img/obol_og_image.png"><meta data-rh="true" property="og:image:width" content="1200"><meta data-rh="true" property="og:image:height" content="630"><meta data-rh="true" name="docusaurus_version" content="v0.6.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v0.6.1"><meta data-rh="true" name="docsearch:version" content="v0.6.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v0.6.1"><meta data-rh="true" property="og:title" content="Distributed Validator Key Generation | Obol Network"><meta data-rh="true" name="description" content="Contents"><meta data-rh="true" property="og:description" content="Contents"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.obol.tech/docs/v0.6.1/dvk/distributed-validator-keys"><link data-rh="true" rel="alternate" href="https://docs.obol.tech/docs/v0.6.1/dvk/distributed-validator-keys" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.obol.tech/docs/v0.6.1/dvk/distributed-validator-keys" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DTT2S469C4"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DTT2S469C4",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.3af86dac.css">
<link rel="preload" href="/assets/js/runtime~main.4c0c9498.js" as="script">
<link rel="preload" href="/assets/js/main.8a1cab60.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ObolIconDark.svg" alt="Obol Network Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/ObolIconLight.svg" alt="Obol Network Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Obol Network</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/v0.6.1/int/Overview">Docs</a><a class="navbar__item navbar__link" href="/api">API</a><a class="navbar__item navbar__link" href="/docs/sdk">SDK</a><a href="https://blog.obol.tech" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/obolnetwork/obol-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/v0.6.1/intro">v0.6.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/int/Overview">Next</a></li><li><a class="dropdown__link" href="/docs/int/Overview">v1.0.0</a></li><li><a class="dropdown__link" href="/docs/v0.19.2/int/Overview">v0.19.2</a></li><li><a class="dropdown__link" href="/docs/v0.19.1/int/Overview">v0.19.1</a></li><li><a class="dropdown__link" href="/docs/v0.19.0/intro">v0.19.0</a></li><li><a class="dropdown__link" href="/docs/v0.18.0/intro">v0.18.0</a></li><li><a class="dropdown__link" href="/docs/v0.17.1/intro">v0.17.1</a></li><li><a class="dropdown__link" href="/docs/v0.17.0/intro">v0.17.0</a></li><li><a class="dropdown__link" href="/docs/v0.16.0/intro">v0.16.0</a></li><li><a class="dropdown__link" href="/docs/v0.15.0/intro">v0.15.0</a></li><li><a class="dropdown__link" href="/docs/v0.14.4/intro">v0.14.4</a></li><li><a class="dropdown__link" href="/docs/v0.14.0/intro">v0.14.0</a></li><li><a class="dropdown__link" href="/docs/v0.13.0/intro">v0.13.0</a></li><li><a class="dropdown__link" href="/docs/v0.12.0/dvk/distributed-validator-keys">v0.12.0</a></li><li><a class="dropdown__link" href="/docs/v0.11.0/dvk/distributed-validator-keys">v0.11.0</a></li><li><a class="dropdown__link" href="/docs/v0.10.1/dvk/distributed-validator-keys">v0.10.1</a></li><li><a class="dropdown__link" href="/docs/v0.10.0/dvk/distributed-validator-keys">v0.10.0</a></li><li><a class="dropdown__link" href="/docs/v0.9.0/dvk/distributed-validator-keys">v0.9.0</a></li><li><a class="dropdown__link" href="/docs/v0.8.1/dvk/distributed-validator-keys">v0.8.1</a></li><li><a class="dropdown__link" href="/docs/v0.8.0/dvk/distributed-validator-keys">v0.8.0</a></li><li><a class="dropdown__link" href="/docs/v0.7.0/dvk/distributed-validator-keys">v0.7.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/v0.6.1/dvk/distributed-validator-keys">v0.6.1</a></li><li><a class="dropdown__link" href="/docs/v0.6.0/dvk/distributed-validator-keys">v0.6.0</a></li><li><a class="dropdown__link" href="/docs/v0.5.0/dvk/distributed-validator-keys">v0.5.0</a></li><li><a class="dropdown__link" href="/docs/v0.4.0/dvk/distributed-validator-keys">v0.4.0</a></li><li><a class="dropdown__link" href="/docs/v0.3.0/dvk/distributed-validator-keys">v0.3.0</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-v0.6.1"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v0.6.1/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/v0.6.1/int/Overview">Getting started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/int/Overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/int/key-concepts">Key concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/docs/v0.6.1/int/quickstart">Quickstart Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quickstart Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/int/quickstart/quickstart-alone">Run a cluster alone</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/int/quickstart/quickstart-group">Run a cluster with others</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/int/working-groups">Working groups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/int/faq">Frequently asked questions</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docs/v0.6.1/dv/introducing-charon">Distributed validators</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dv/introducing-charon">Introducing Charon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dv/validator-creation">Distributed validator creation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dv/middleware-daemon">Middleware Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dv/peer-discovery">Peer discovery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dv/p2p-interface">P2P interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dv/distributed-validator-cluster-manifest">Cluster Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dv/charon_cli_reference">Charon CLI reference</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/v0.6.1/dvk/distributed-validator-keys">Key generation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/v0.6.1/dvk/distributed-validator-keys">Distributed Validator Key Generation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dvk/distributed_validator_launchpad">Distributed Validator launchpad</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/v0.6.1/dvk/dkg_cli_reference">DKG CLI reference</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/v0.6.1/sc/introducing-obol-managers">Smart contracts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/v0.6.1/cg/bug-report">Contribution guidelines</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/v0.6.1/fr/eth">Further reading</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v0.6.1/testnet">Testnets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/v0.6.1/glossary">Glossary</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Obol Network<!-- --> <b>v0.6.1</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/int/Overview">latest version</a></b> (<!-- -->v1.0.0<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Key generation</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Distributed Validator Key Generation</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v0.6.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Distributed Validator Key Generation</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="contents">Contents<a href="#contents" class="hash-link" aria-label="Direct link to Contents" title="Direct link to Contents">​</a></h2><ul><li><a href="#overview">Overview</a></li><li><a href="#actors-involved">Actors involved</a></li><li><a href="#cluster-definition-creation">Cluster Definition creation</a></li><li><a href="#carrying-out-the-dkg-ceremony">Carrying out the DKG ceremony</a></li><li><a href="#backing-up-the-ceremony-artifacts">Backing up ceremony artifacts</a></li><li><a href="#preparing-for-validator-activation">Preparing for validator activation</a></li><li><a href="#dkg-verification">DKG verification</a></li><li><a href="#appendix">Appendix</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2><p>A distributed validator key is a group of BLS private keys that together operate as a threshold key for participating in proof-of-stake consensus.</p><p>To make a distributed validator with no fault-tolerance (i.e. all nodes need to be online to sign every message), due to the BLS signature scheme used by Proof of Stake Ethereum, each key share could be chosen by operators independently. However, to create a distributed validator that can stay online despite a subset of its nodes going offline, the key shares need to be generated together. (4 randomly chosen points on a graph don&#x27;t all neccessarily sit on the same order three curve.) To do this in a secure manner with no one party being trusted to distribute the keys requires what is known as a distributed key generation ceremony.</p><p>The charon client has the responsibility of securely completing a distributed key generation ceremony with its counterparty nodes. The ceremony configuration is outlined in a <a href="https://docs.obol.tech/docs/dv/distributed-validator-cluster-manifest" target="_blank" rel="noopener noreferrer">cluster definition</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="actors-involved">Actors Involved<a href="#actors-involved" class="hash-link" aria-label="Direct link to Actors Involved" title="Direct link to Actors Involved">​</a></h2><p>A distributed key generation ceremony involves <code>Operators</code> and their <code>Charon clients</code>.</p><ul><li><p>An <code>Operator</code> is identified by their Ethereum address. They will sign with this address&#x27;s private key to authenticate their charon client ahead of the ceremony. The signature will be of; a hash of the charon clients ENR public key, the <code>cluster_definition_hash</code>, and an incrementing <code>nonce</code>, allowing for a direct linkage between a user, their charon client, and the cluster this client is intended to service, while retaining the ability to update the charon client by incrementing the nonce value and re-signing like the standard ENR spec.</p></li><li><p>A <code>Charon client</code> is also identified by a public/private key pair, in this instance, the public key is represented as an <a href="https://eips.ethereum.org/EIPS/eip-778" target="_blank" rel="noopener noreferrer">Ethereum Node Record</a> (ENR). This is a standard identity format for both EL and CL clients. These ENRs are used by each charon node to identify its cluster peers over the internet, and to communicate with one another in an <a href="https://github.com/libp2p/go-libp2p-noise" target="_blank" rel="noopener noreferrer">end to end encrypted manner</a>. These keys need to be created by each operator before they can participate in a cluster creation.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cluster-definition-creation">Cluster Definition Creation<a href="#cluster-definition-creation" class="hash-link" aria-label="Direct link to Cluster Definition Creation" title="Direct link to Cluster Definition Creation">​</a></h2><p>This definition file is created with the help of the <a href="https://docs.obol.tech/docs/dvk/distributed_validator_launchpad" target="_blank" rel="noopener noreferrer">Distributed Validator Launchpad</a>. The creation process involves a number of steps.</p><ul><li>A <code>leader</code> Operator, that wishes to co-ordinate the creation of a new Distributed Validator Cluster navigates to the launch pad and selects &quot;Create new Cluster&quot;</li><li>The <code>leader</code> uses the user interface to configure all of the important details about the cluster including:<ul><li>The <code>withdrawal address</code> for the created validators</li><li>The <code>feeRecipient</code> for block proposals if it differs from the withdrawal address</li><li>The number of distributed validators to create</li><li>The list of participants in the cluster specified by Ethereum address(/ENS)</li><li>The threshold of fault tolerance required (if not choosing the safe default)</li><li>The network (fork_version/chainId) that this cluster will validate on</li></ul></li><li>These key pieces of information form the basis of the cluster configuration. These fields (and some technical fields like DKG algorithm to use) are serialised and merklised to produce the definition&#x27;s <code>cluster_definition_hash</code>. This merkle root will be used to confirm that their is no ambiguity or deviation between definitions when they are provided to charon nodes.</li><li>Once the leader is satisfied with the configuration they publish it to the launchpad&#x27;s data availability layer for the other participants to access. (For early development the launchpad will use a centralised backend db to store the cluster configuration. Near production, solutions like IPFS or arweave may be more suitable for the long term decentralisation of the launchpad.)</li><li>The leader will then share the URL to this ceremony with their intended participants.</li><li>Anyone that clicks the ceremony url, or inputs the <code>cluster_definition_hash</code> when prompted on the landing page will be brought to the ceremony status page. (After completing all disclaimers and advisories)</li><li>A &quot;Connect Wallet&quot; button will be visible beneath the ceremony status container, a participant can click on it to connect their wallet to the site<ul><li>If the participant connects a wallet that is not in the participant list, the button disables, as there is nothing to do</li><li>If the participant connects a wallet that is in the participant list, they get prompted to input the ENR of their charon node.</li><li>If the ENR field is populated and validated the participant can now see a &quot;Confirm Cluster Configuration&quot; button. This button triggers one/two signatures.<ul><li>The participant signs the <code>cluster_definition_hash</code>, to prove they are consensting to this exact configuration.</li><li>The participant signs their charon node&#x27;s ENR, to authenticate and authorise that specific charon node to participate on their behalf in the distributed validator cluster.</li></ul></li><li>These/this signature is sent to the data availability layer, where it verifies the signatures are correct for the given participants ethereum address. If the signatures pass validation, the signature of the definition hash and the the ENR + signature get saved to the definition object.</li></ul></li><li>All participants in the list must sign the definition hash and submit a signed ENR before a DKG ceremony can begin. The outstanding signatures can be easily displayed on the status page.</li><li>Finally, once all participants have signed their approval, and submitted a charon node ENR to act on their behalf, the definition data can be downloaded as a file if the users click a newly displayed button, <code>Download Manifest</code>.</li><li>At this point each participant must load this definition into their charon client, and the client will attempt to complete the DKG.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="carrying-out-the-dkg-ceremony">Carrying out the DKG ceremony<a href="#carrying-out-the-dkg-ceremony" class="hash-link" aria-label="Direct link to Carrying out the DKG ceremony" title="Direct link to Carrying out the DKG ceremony">​</a></h2><p>Once participant has their definition file prepared, they will pass the file to charon&#x27;s <code>dkg</code> command. Charon will read the ENRs in the definition, confirm that its ENR is present, and then will reach out to bootnodes that are deployed to find the other ENRs on the network. (Fresh ENRs just have a public key and an IP address of 0.0.0.0 until they are loaded into a live charon client, which will update the IP address and increment the ENRs nonce and resign with the clients private key. If an ENR with a higher nonce is seen be a charon client, they will update the IP address of that ENR in their address book.)</p><p>Once all clients in the cluster can establish a connection with one another and they each complete a handshake (confirm everyone has a matching <code>cluster_definition_hash</code>), the ceremony begins.</p><p>No user input is required, charon does the work and outputs the following files to each machine and then exits.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Common data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.cluster-definition.json          # The original definition file from the DV Launchpad or `charon create dkg`</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.cluster-lock.json                # New lockfile based on cluster-definition.json with validator group public keys and threshold BLS verifiers included with the initial cluster config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.charon/deposit-data.json         # JSON file of deposit data for the distributed validators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Sensitive operator-specific data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.charon/charon-enr-private-key    # Created before the ceremony took place [Back this up]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">.charon/validator_keys/           # Folder of key shares to be backed up and moved to validator client [Back this up]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="backing-up-the-ceremony-artifacts">Backing up the ceremony artifacts<a href="#backing-up-the-ceremony-artifacts" class="hash-link" aria-label="Direct link to Backing up the ceremony artifacts" title="Direct link to Backing up the ceremony artifacts">​</a></h2><p>Once the ceremony is complete, all participants should take a backup of the created files. In future versions of charon, if a participant loses access to these key shares, it will be possible to use a key re-sharing protocol to swap the participants old keys out of a distributed validator in favour of new keys, allowing the rest of a cluster to recover from a set of lost key shares. However for now, without a backup, the safest thing to do would be to exit the validator.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-for-validator-activation">Preparing for validator activation<a href="#preparing-for-validator-activation" class="hash-link" aria-label="Direct link to Preparing for validator activation" title="Direct link to Preparing for validator activation">​</a></h2><p>Once the ceremony is complete, and secure backups of key shares have been made by each operator. They must now load these key shares into their validator clients, and run the <code>charon run</code> command to turn it into operational mode.</p><p>All operators should confirm that their charon client logs indicate all nodes are online and connected. They should also verify the readiness of their beacon clients and validator clients. Charon&#x27;s grafana dashboard is a good way to see the readiness of the full cluster from its perspective.</p><p>Once all operators are satisfied with network connectivity, one member can use the Obol Distributed Validator deposit flow to send the required ether and deposit data to the deposit contract, beginning the process of a distributed validator activation. Good luck.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dkg-verification">DKG Verification<a href="#dkg-verification" class="hash-link" aria-label="Direct link to DKG Verification" title="Direct link to DKG Verification">​</a></h2><p>For many use cases of distributed validators, the funder/depositor of the validator may not be the same person as the key creators/node operators, as (outside of the base protocol) stake delegation is a common phenomenon. This handover of information introduces a point of trust. How does someone verify that a proposed validator <code>deposit data</code> corresponds to a real, fair, DKG with participants the depositor expects?</p><p>There are a number of aspects to this trust surface that can be mitigated with a &quot;Don&#x27;t trust, verify&quot; model. Verification for the time being is easier off chain, until things like a <a href="https://eips.ethereum.org/EIPS/eip-2537" target="_blank" rel="noopener noreferrer">BLS precompile</a> are brought into the EVM, along with cheap ZKP verification on chain. Some of the questions that can be asked of Distributed Validator Key Generation Ceremonies include:</p><ul><li>Do the public key shares combine together to form the group public key?<ul><li>This can be checked on chain as it doe not require a pairing operation</li><li>This can give confidence that a BLS pubkey represents a Distributed Validator, but does not say anything about the custody of the keys. (e.g. Was the ceremony sybil attacked, did they collude to reconstitute the group private key etc.)</li></ul></li><li>Do the created BLS public keys attest to their <code>cluster_definition_hash</code>?<ul><li>This is to create a backwards link between newly created BLS public keys and the operator&#x27;s eth1 addresses that took part in their creation.</li><li>If a proposed distributed validator BLS group public key can produce a signature of the <code>cluster_definition_hash</code>, it can be inferred that at least a threshold of the operators signed this data.</li><li>As the <code>cluster_definition_hash</code> is the same for all distributed validators created in the ceremony, the signatures can be aggregated into a group signature that verifies all created group keys at once. This makes it cheaper to verify a number of validators at once on chain.</li></ul></li><li>Is there either a VSS or PVSS proof of a fair DKG ceremony?<ul><li>VSS (Verifiable Secret Sharing) means only operators can verify fairness, as the proof requires knowledge of one of the secrets.</li><li>PVSS (Publicly Verifiable Secret Sharing) means anyone can verify fairness, as the proof is usually a Zero Knowledge Proof.</li><li>A PVSS of a fair DKG would make it more difficult for operators to collude and undermine the security of the Distributed Validator.</li><li>Zero Knowledge Proof verification on chain is currently expensive, but is becoming achievable through the hard work and research of the many ZK based teams in the industry.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix">Appendix<a href="#appendix" class="hash-link" aria-label="Direct link to Appendix" title="Direct link to Appendix">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-dkg-without-the-launchpad">Using DKG without the launchpad<a href="#using-dkg-without-the-launchpad" class="hash-link" aria-label="Direct link to Using DKG without the launchpad" title="Direct link to Using DKG without the launchpad">​</a></h3><p>Charon clients can do a DKG with a definition file that does not contain operator signatures if you pass a <code>--no-verify</code> flag to <code>charon dkg</code>. This can be used for testing purposes when strict signature verification is not of the utmost importance.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sample-configuration-and-lock-files">Sample Configuration and Lock Files<a href="#sample-configuration-and-lock-files" class="hash-link" aria-label="Direct link to Sample Configuration and Lock Files" title="Direct link to Sample Configuration and Lock Files">​</a></h3><p>Refer to the details <a href="/docs/v0.6.1/dv/distributed-validator-cluster-manifest#cluster-configuration-files">here</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ObolNetwork/obol-docs/edit/main/versioned_docs/version-v0.6.1/dvk/01_distributed-validator-keys.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/v0.6.1/dv/charon_cli_reference"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Charon CLI reference</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/v0.6.1/dvk/distributed_validator_launchpad"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Distributed Validator launchpad</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#contents" class="table-of-contents__link toc-highlight">Contents</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#actors-involved" class="table-of-contents__link toc-highlight">Actors Involved</a></li><li><a href="#cluster-definition-creation" class="table-of-contents__link toc-highlight">Cluster Definition Creation</a></li><li><a href="#carrying-out-the-dkg-ceremony" class="table-of-contents__link toc-highlight">Carrying out the DKG ceremony</a></li><li><a href="#backing-up-the-ceremony-artifacts" class="table-of-contents__link toc-highlight">Backing up the ceremony artifacts</a></li><li><a href="#preparing-for-validator-activation" class="table-of-contents__link toc-highlight">Preparing for validator activation</a></li><li><a href="#dkg-verification" class="table-of-contents__link toc-highlight">DKG Verification</a></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a><ul><li><a href="#using-dkg-without-the-launchpad" class="table-of-contents__link toc-highlight">Using DKG without the launchpad</a></li><li><a href="#sample-configuration-and-lock-files" class="table-of-contents__link toc-highlight">Sample Configuration and Lock Files</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/int/Overview">Intro to Obol</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/charon/intro">Charon</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/dvl/intro">DV Launchpad</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/n6ebKsX46w" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/obolnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.obol.tech/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/obolnetwork/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://obol.tech/" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/ObolLineWhite.svg" alt="Obol Network Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="30px" height="30px"><img src="/img/ObolLineWhite.svg" alt="Obol Network Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="30px" height="30px"></a></div><div class="footer__copyright">Copyright © 2024 Obol Labs, Inc. </div></div></div></footer></div>
<script src="/assets/js/runtime~main.4c0c9498.js"></script>
<script src="/assets/js/main.8a1cab60.js"></script>
</body>
</html>